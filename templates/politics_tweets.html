<html>
	<!--<link rel="stylesheet" media="screen" href= "/static/bootstrap.min.css"> -->
	<link rel="stylesheet" media="screen" href= "{{ url_for('static', filename='bootstrap.min.css') }}">
	<link rel="stylesheet" type="text/css" href= "{{ url_for('static', filename='make_tables.css') }}" />
	<head>
		
			<style>
				.PP_members{
					background-color: #2ECCFA;   
					border-radius: 25px;
				}
				.PSOE_members{
					background-color: #FF0000;
					border-radius: 25px;
				}
				.PODEMOS_members{
					background-color: #672F6C;
					border-radius: 25px;
				}
				.CIUDADANOS_members{
					background-color: orange;
					border-radius: 25px;
				}
				.COMPROMIS_members{
					background-color: #E65F00;
					border-radius: 25px;
				}
				.VOX_members{
					background-color: green;
					border-radius: 25px;
				}
				.member{
					background-color: #E6E6E6;
					border-radius: 25px;
				}
				.member:hover {
  				box-shadow: 0 0 15px rgba(0, 0, 0, 0.7); 
				}

				.graph {
				height: auto;
				width: auto;
				max-width: 800px;
				margin: 0 auto;
			}
			#search_type_distribution{
				height: 80%;
			}

			.highcharts-pie-series .highcharts-point {
				stroke: #EDE;
				stroke-width: 2px;
			}
			.highcharts-pie-series .highcharts-data-label-connector {
				stroke: silver;
				stroke-dasharray: 2, 2;
				stroke-width: 2px;
			}
			.primera_fila{
				display: flex
			}

			.percentage_bar_div{
				width: 100%;
				height: 50% !important;
				background-color: grey !important;
				color: transparent; ;
			}
			.percentage_bar{
				width: 100%;
				height: 100% !important;
			}



			</style>
	</head>
	<body class="body">
		<header>
			<!-- <h3>{{ webpage_title }}</h3> -->
		</header>
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
				<a class="navbar-brand" href="./">TFG_NAV</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
			  
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
				  <ul class="navbar-nav mr-auto">
					<li class="nav-item">
					  <a class="nav-link" href="/statistics">General Statistics<span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
					  <a class="nav-link" href="/rankings">Rankings</a>
					</li>
					<li class="nav-item active">
							<a class="nav-link" href="/politics_tweets">Politics tweets analysis</a>
					</li>




					<li class="nav-item dropdown">
					  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Collection
					  </a>
					  <div class="dropdown-menu" aria-labelledby="navbarDropdown" id="collection_dropdown_menu">
							{% for c in collections %}
							<a class="dropdown-item" href=".">{{ c }}</a>
							{% endfor %}

						<!-- <a class="dropdown-item" href="#">Another action</a> -->
						<!-- <div class="dropdown-divider"></div>
						<a class="dropdown-item" href="#">Something else here</a> -->
					  </div>
					</li>
					<li class="nav-item">
					  <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">collection = {{ collection }}</a>
					</li>
				  </ul>
				  <form class="form-inline my-2 my-lg-0">
					<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
					<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
				  </form>
				</div>
			  </nav>

		



		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://code.highcharts.com/highcharts.js"></script>
		<script src="https://code.highcharts.com/modules/series-label.js"></script>
		<script src="https://code.highcharts.com/modules/exporting.js"></script>
		<script src="https://code.highcharts.com/modules/export-data.js"></script>
		<script src="{{ url_for('static', filename='js/get_users_of_a_political_party.js') }}"></script>
		<script src="{{ url_for('static', filename='js/put_politics_section.js') }}"></script>
		<script src="{{ url_for('static', filename='js/put_semi_circle_graph.js') }}"></script>
		<script src="{{ url_for('static', filename='js/get_num_tweets_by_party.js') }}"></script>
		<script src="{{ url_for('static', filename='js/get_num_likes_by_party.js') }}"></script>
		<script src="{{ url_for('static', filename='js/make_table_with_special_doc.js') }}"></script>
		<script src="{{ url_for('static', filename='js/make_table_with_percentage_bar.js') }}"></script>

		
			
		<div id="miembros_PP" class="d-flex w-100 mb-3 px-3 justify-content-between flex-column PP_members"></div>
		<div id="miembros_PSOE" class="d-flex w-100 mb-3 px-3 justify-content-between flex-column PSOE_members"></div>
		<div id="miembros_CIUDADANOS" class="d-flex w-100 mb-3 px-3  justify-content-between flex-column CIUDADANOS_members"></div>
		<div id="miembros_PODEMOS" class="d-flex w-100 mb-3 px-3 justify-content-between flex-column PODEMOS_members"></div>
		<div id="miembros_COMPROMIS" class="d-flex w-100 mb-3 px-3 justify-content-between  flex-column COMPROMIS_members"></div>
		<div id="miembros_VOX" class="d-flex w-100 mb-3 px-3 justify-content-between  flex-column VOX_members"></div>

<!-- SECCION USUARIOS DE PARTIDOS ------------------------------------------------------------------------------------>
		<script>
			var json_searched_users_file = {{ searched_users_file|tojson }};
			var politicos_pp = get_users_of_a_political_party(json_searched_users_file,"PP");
			var politicos_psoe = get_users_of_a_political_party(json_searched_users_file,"PSOE");
			var politicos_podemos = get_users_of_a_political_party(json_searched_users_file,"PODEMOS");
			var politicos_ciudadanos = get_users_of_a_political_party(json_searched_users_file,"CIUDADANOS");
			var politicos_vox = get_users_of_a_political_party(json_searched_users_file,"VOX");
			var politicos_compromis = get_users_of_a_political_party(json_searched_users_file,"COMPROMIS");
			if (politicos_pp.length>0){
				put_politics_section(politicos_pp,"PP","miembros_PP",json_searched_users_file);
			}
			if (politicos_psoe.length>0){
				put_politics_section(politicos_psoe,"PSOE","miembros_PSOE",json_searched_users_file);
			}
			if (politicos_ciudadanos.length>0){
				put_politics_section(politicos_ciudadanos,"CIUDADANOS","miembros_CIUDADANOS",json_searched_users_file);
			}
			if (politicos_podemos.length>0){
				put_politics_section(politicos_podemos,"PODEMOS","miembros_PODEMOS",json_searched_users_file);
			}
			if(politicos_compromis.length>0){
				put_politics_section(politicos_compromis,"COMPROMIS","miembros_COMPROMIS",json_searched_users_file);
			}
			if(politicos_vox.length>0){
				put_politics_section(politicos_vox,"VOX","miembros_VOX",json_searched_users_file);
			}
		</script>

<!-- SECCION USUARIOS DE PARTIDOS ------------------------------------------------------------------------------------>

		<div id="primera_fila" class="d-flex w-100 mb-3 justify-content-between flex-row">
					<div class="mb-1 graph" id="tweets_distribution"></div>
					<div class="mb-1 graph" id="likes_distribution"></div>
		</div>

		<script>
				var dict_tweets = get_num_tweets_by_party({{ searched_users_file|tojson }});
				var series_data = [
					[ "PP", dict_tweets.PP],
					[ "PSOE",dict_tweets.PSOE],
					[ "CIUDADANOS",dict_tweets.CIUDADANOS],
					[ "PODEMOS",dict_tweets.PODEMOS],
					[ "COMPROMIS",dict_tweets.COMPROMIS],
					[ "VOX",dict_tweets.VOX]
				];
				var colors = ['#2ECCFA', '#FF0000','#FF8000','#672F6C', '#E65F00' ,'#40FF00']
				put_semi_circle_graph("tweets_distribution","Distribución <br> tweets <br> capturados",series_data,"Mensajes",colors);
			</script>

			<script>
					var json_users_file = {{ users_file|tojson }};
					if (json_users_file!= null){
						var dict_likes = get_num_likes_by_party(json_users_file);
						var series_data = [
							[ "PP", dict_likes.PP],
							[ "PSOE",dict_likes.PSOE],
							[ "CIUDADANOS",dict_likes.CIUDADANOS],
							[ "PODEMOS",dict_likes.PODEMOS],
							[ "COMPROMIS",dict_likes.COMPROMIS],
							[ "VOX",dict_likes.VOX]
						];
						var colors = ['#2ECCFA', '#FF0000','#FF8000','#672F6C', '#E65F00' ,'#40FF00']
						put_semi_circle_graph("likes_distribution","Distribución <br> likes <br> capturados",series_data,"Likes",colors);
					}
					</script>

<!-- SECCION TABLA LIKES POR USUARIO  ------------------------------------------------------------------------------------>

			<script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
			<script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.5/lodash.min.js"> </script>
			<br><br><br>
			<h5>LIKES CAPTURADOS POR USUARIO</h5>
			<div id="likes_capturados">
				<table class="table table-striped table-dark aux_header" id="tabla_likes_capturados_header_container">
				</table>
				<table class="table table-striped list table-dark" id="tabla_likes_capturados">
				</table>
				<ul class="pagination"></ul>
			</div>
			<script>make_table_with_special_doc('likes_capturados','tabla_likes_capturados_header_container','tabla_likes_capturados',
			['user_screen_name','likes_to_PP','likes_to_PSOE','likes_to_PODEMOS','likes_to_CIUDADANOS','likes_to_COMPROMIS','likes_to_VOX','last_like_registered'],
			{{ users_file|tojson }})
			</script>

<!-- SECCION LIKES CAPTURADOS POR TWEET  ------------------------------------------------------------------------------------>

<h5>LIKES CAPTURADOS POR TWEET</h5>
<div id="likes_capturados_por_tweet">
	<table class="table table-striped table-dark aux_header" id="likes_capturados_por_tweet_header_container">
	</table>
	<table class="table table-striped list table-dark" id="tabla_likes_capturados_por_tweet">
	</table>
	<!--<ul class="pagination"></ul>-->
</div>
	<script>
	// var json_likes_list_file = {{ likes_list_file|tojson }}
	// for( var key in json_likes_list_file){
	// 	json_likes_list_file[key]["num_likes_capturados"]
	// }
	make_table_with_percentage_bar('likes_capturados_por_tweet','likes_capturados_por_tweet_header_container','tabla_likes_capturados_por_tweet',
	['tweet_id','user_screen_name','num_likes_capturados','num_likes','last_like_resgistered'],
	"num_likes_capturados","num_likes",
	{{ likes_list_file|tojson }})
	</script>


	<script>
	$('li.percentage_bar').each(function(){
		var text = $(this).text();
		var text_perc = Math.trunc( text ).toString()+'%'
		//alert(text_perc)
		if(text >=0 && text< 40){
			$(this).css('background-color','red');
			// $(this).style.width = text_perc;
		}else if (text >= 40 && text< 55){
			$(this).css('background-color','orange');
		}else if (text >= 55 && text< 70){
			$(this).css('background-color','yellow');
		}else{
			$(this).css('background-color','green');
		}
		$(this).width(text_perc);
		if(text <=1){
			$(this).width("1%");
		}

	});
	</script>


	</body>

	<script type = "text/javascript" src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/get_dropdown_selection.js') }}"></script>

	</html>